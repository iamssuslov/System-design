# Документация системы хранения файлов

## Ключевые варианты использования

1. **Создание папок и добавление файлов:**

   Пользователь через **Folder Service** создаёт новую папку. Затем через **File Service** добавляет файлы в папку и назначает права для пользователей, данные о которых получаются из **User Service**. Это позволяет надёжно и безопасно использовать файлы.

2. **Поиск и обновление файлов и папок:**

   Пользователь через **Folder Service** и **File Service** может искать и изменять папки и файлы прямо в приложении. Это обеспечивает эффективную обработку файлов и папок.

## Архитектура

Система управления проектами разделена на три основных сервиса в соответствии с принципами DDD:

1. **User Service**:

   - **Ответственность**: Управление пользователями.
   - **База данных**: Хранит информацию о пользователях.
   - **API**:
     - Создание нового пользователя.
     - Поиск пользователя по логину.
     - Поиск пользователя по маске имени и фамилии.

2. **Folder Service**:

   - **Ответственность**: Управление папками.
   - **База данных**: Хранит информацию о проектах.
   - **API**:
     - Создание папки.
     - Поиск папки по имени.
     - Получение всех папок.
   - **Межсервисное взаимодействие**: Обращается к **User Service** для валидации прав.

3. **File Service**:

   - **Ответственность**: Управление файлами.
   - **База данных**: Хранит информацию о файлах.
   - **API**:
     - Создание файла в хранилище.
     - Получение всех файллов в хранилище.
     - Получение файла по маске.
   - **Межсервисное взаимодействие**: Обращается к **User Service** для валидации прав.

### Межсервисное взаимодействие

- **Folder Service** и **File Service** запрашивают данные у **User Service** для наличия  прав на взаимодействие.
- Коммуникация осуществляется через REST API. Планируется внедрение брокера сообщений для асинхронной коммуникации.

## Нефункциональные требования

1. **Безопасность**: Данные шифруются, чтобы злоумышенники не получили доступ к чувствительной информации пользователей.
2. **Производительность**: Оптимизация каждого сервиса для быстрого отклика.
3. **Надежность**: Высокая доступность сервисов; отказ одного не должен влиять на работу других.
4. **Масштабируемость**: Возможность масштабирования каждого сервиса независимо в зависимости от нагрузки.

## API

### User Service

- **POST /users** - Создание нового пользователя
  - Тело запроса: `{ "login": "string", "name": "string", "email": "string" }`
  - Ответ: `{ "id": "string", "login": "string", "name": "string", "email": "string" }`

- **GET /users?login={login}** - Поиск пользователя по логину
  - Ответ: `{ "id": "string", "login": "string", "name": "string", "email": "string" }`

- **GET /users?name={name}** - Поиск пользователя по маске имени и фамилии
  - Ответ: `[{ "id": "string", "login": "string", "name": "string", "email": "string" }, ...]`

### Folder Service

- **POST /folders** - Создание папки
  - Тело запроса: `{ "name": "string" }`
  - Ответ: `{ "name": "string", "return_code": "int", "code_description": "string" }`

- **GET /folders?name={name}** - Поиск папки по имени
  - Ответ: `[{"name": "string", "path": "string" }, ...]`

- **GET /folders** - Получение всех проектов
  - Ответ: `[{"name": "string", "path": "string" }, ...]`

### File Service

- **POST /files** - Создание папки
  - Тело запроса: `{ "name": "string" }`
  - Ответ: `{ "name": "string", "return_code": "int", "code_description": "string" }`

- **GET /files?name={name}** - Поиск файла по имени
  - Ответ: `[{"name": "string", "path": "string" }, ...]`

- **GET /files** - Получение всех файлов
  - Ответ: `[{"name": "string", "path": "string" }, ...]`

## Технологии

- **Язык и фреймворки**: Python, Django и Flask
- **Базы данных**: PostgreSQL (отдельная база для каждого сервиса)
- **ORM**: SQLAlchemy
- **Коммуникация**:
  - RESTful API over HTTPS для взаимодействия с клиентами
  - REST API между сервисами
- **Аутентификация и авторизация**: OAuth 2.0 (централизованный сервис или распределённая настройка)
- **Контейнеризация и оркестрация**: Docker и Kubernetes
- **Межсервисная коммуникация**: Возможность использования брокера сообщений для повышения надёжности и асинхронности

## Дальнейшее развитие

1. **Улучшение межсервисной коммуникации**: Внедрение брокера сообщений для асинхронного взаимодействия и повышения отказоустойчивости.

2. **Централизованный сервис аутентификации**: Разработка отдельного Auth Service для управления аутентификацией и авторизацией.

3. **Мониторинг и логирование**: Внедрение инструментов для централизованного мониторинга и логирования работы сервисов.

4. **Интеграция с внешними системами**: Реализация интеграции с инструментами CI/CD, системами контроля версий и другими внешними сервисами.
